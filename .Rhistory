i = "150"
depth <- c("150", "200", "300", "400")
test.object <- NULL
for (i in depth){
test <- cbind(i,get(paste0("M_flux.depth.", i))[,9])
test.object <- rbind(test.object,test)
}
test.object <- as.data.frame(test.object)
#View(test.object)
boxplot(log(as.numeric(test.object$V2))~test.object$i)
Dsts.test <- rbind(cbind(M_flux.depth.150$M_avg.150))
# Checking for normaility and no outliers in Phosporous Flux
par(mfrow=c(1,3))
hist((P_flux.depth.150$P_avg.150), breaks = "FD", main ="Fig 29 P Flux depth 150")
hist((P_flux.depth.200$P_avg.200), breaks = "FD", main ="Fig 30 P Flux depth 200")
hist((P_flux.depth.300$P_avg.300), breaks = "FD", main ="Fig 31 P Flux depth 300")
# using natural log to Transform the data
par(mfrow=c(1,3))
hist(log(P_flux.depth.150$P_avg.150), main ="Fig 32 P Flux depth 150 (log)")
hist(log(P_flux.depth.200$P_avg.200), main ="Fig 33 P Flux depth 200 (log)")
hist(log(P_flux.depth.300$P_avg.300), main ="Fig 34 P Flux depth 300 (log)")
# Checking for outliers
par(mfrow=c(1,1))
i = "150"
depth <- c("150", "200", "300")
test.object <- NULL
for (i in depth){
test <- cbind(i,get(paste0("P_flux.depth.", i))[,9])
test.object <- rbind(test.object,test)
}
test.object <- as.data.frame(test.object)
#View(test.object)
boxplot(log(as.numeric(test.object$V2))~test.object$i)
Dsts.test <- rbind(cbind(P_flux.depth.150$P_avg.150), main = "Figure")
# Checking for normaility and no outliers in Phosporous Flux
par(mfrow=c(1,3))
hist((P_flux.depth.150$P_avg.150), breaks = "FD", main ="Fig 29 P Flux depth 150")
hist((P_flux.depth.200$P_avg.200), breaks = "FD", main ="Fig 30 P Flux depth 200")
hist((P_flux.depth.300$P_avg.300), breaks = "FD", main ="Fig 31 P Flux depth 300")
# using natural log to Transform the data
par(mfrow=c(1,3))
hist(log(P_flux.depth.150$P_avg.150), main ="Fig 32 P Flux depth 150 (log)")
hist(log(P_flux.depth.200$P_avg.200), main ="Fig 33 P Flux depth 200 (log)")
hist(log(P_flux.depth.300$P_avg.300), main ="Fig 34 P Flux depth 300 (log)")
# Checking for outliers
par(mfrow=c(1,1))
i = "150"
depth <- c("150", "200", "300")
test.object <- NULL
for (i in depth){
test <- cbind(i,get(paste0("P_flux.depth.", i))[,9])
test.object <- rbind(test.object,test)
}
test.object <- as.data.frame(test.object)
#View(test.object)
boxplot(log(as.numeric(test.object$V2))~test.object$i, main = "Figure")
Dsts.test <- rbind(cbind(P_flux.depth.150$P_avg.150))
# Checking for normaility and no outliers in Phosporous Flux
par(mfrow=c(1,3))
hist((P_flux.depth.150$P_avg.150), breaks = "FD", main ="Fig 29 P Flux depth 150")
hist((P_flux.depth.200$P_avg.200), breaks = "FD", main ="Fig 30 P Flux depth 200")
hist((P_flux.depth.300$P_avg.300), breaks = "FD", main ="Fig 31 P Flux depth 300")
# using natural log to Transform the data
par(mfrow=c(1,3))
hist(log(P_flux.depth.150$P_avg.150), main ="Fig 32 P Flux depth 150 (log)")
hist(log(P_flux.depth.200$P_avg.200), main ="Fig 33 P Flux depth 200 (log)")
hist(log(P_flux.depth.300$P_avg.300), main ="Fig 34 P Flux depth 300 (log)")
# Checking for outliers
par(mfrow=c(1,1))
i = "150"
depth <- c("150", "200", "300")
test.object <- NULL
for (i in depth){
test <- cbind(i,get(paste0("P_flux.depth.", i))[,9])
test.object <- rbind(test.object,test)
}
test.object <- as.data.frame(test.object)
#View(test.object)
boxplot(log(as.numeric(test.object$V2))~test.object$i, main = "Figure", xlab = Depth (m), ylab = "log of P-Flux (mg carbon m^-2 day^-1)")
# Checking for normaility and no outliers in Phosporous Flux
par(mfrow=c(1,3))
hist((P_flux.depth.150$P_avg.150), breaks = "FD", main ="Fig 29 P Flux depth 150")
hist((P_flux.depth.200$P_avg.200), breaks = "FD", main ="Fig 30 P Flux depth 200")
hist((P_flux.depth.300$P_avg.300), breaks = "FD", main ="Fig 31 P Flux depth 300")
# using natural log to Transform the data
par(mfrow=c(1,3))
hist(log(P_flux.depth.150$P_avg.150), main ="Fig 32 P Flux depth 150 (log)")
hist(log(P_flux.depth.200$P_avg.200), main ="Fig 33 P Flux depth 200 (log)")
hist(log(P_flux.depth.300$P_avg.300), main ="Fig 34 P Flux depth 300 (log)")
# Checking for outliers
par(mfrow=c(1,1))
i = "150"
depth <- c("150", "200", "300")
test.object <- NULL
for (i in depth){
test <- cbind(i,get(paste0("P_flux.depth.", i))[,9])
test.object <- rbind(test.object,test)
}
test.object <- as.data.frame(test.object)
#View(test.object)
boxplot(log(as.numeric(test.object$V2))~test.object$i, main = "Figure", xlab = "Depth (m)", ylab = "log of P-Flux (mg carbon m^-2 day^-1)")
Dsts.test <- rbind(cbind(P_flux.depth.150$P_avg.150))
# Checking for normaility and no outliers in Nitrogen Flux
hist((N_flux.depth.150$N_avg.150), breaks = "FD", main ="Fig 17 N Flux depth 150")
hist((N_flux.depth.200$N_avg.200), breaks = "FD", main ="Fig 18 N Flux depth 200")
hist((N_flux.depth.300$N_avg.300), breaks = "FD", main ="Fig 19 N Flux depth 300")
hist((N_flux.depth.400$N_avg.400), breaks = "FD", main ="Fig 20 N Flux depth 400")
# using natural log to Transform the data
hist(log(N_flux.depth.150$N_avg.150), main ="Fig 21 N Flux depth 150 (log)")
hist(log(N_flux.depth.200$N_avg.200), main ="Fig 22 N Flux depth 200 (log)")
hist(log(N_flux.depth.300$N_avg.300), main ="Fig 23 N Flux depth 300 (log)")
hist(log(N_flux.depth.400$N_avg.400), main ="Fig 24 N Flux depth 400 (log)")
# Checking for outliers
par(mfrow=c(1,1))
i = "150"
depth <- c("150", "200", "300", "400")
test.object <- NULL
for (i in depth){
test <- cbind(i,get(paste0("N_flux.depth.", i))[,9])
test.object <- rbind(test.object,test)
}
test.object <- as.data.frame(test.object)
#View(test.object)
boxplot(log(as.numeric(test.object$V2))~test.object$i, main = "Figure", xlab = "Depth (m)", ylab = "log of N-Flux (mg nitrogen m^-2 day^-1)")
Dsts.test <- rbind(cbind(N_flux.depth.150$N_avg.150))
# Checking for normaility and no outliers in Carbon Flux
hist((C_flux.depth.150$C_avg.150), main ="Fig 5 C Flux depth 150")
hist((C_flux.depth.200$C_avg.200), main ="Fig 6 C Flux depth 200")
hist((C_flux.depth.300$C_avg.300), main ="Fig 7 C Flux depth 300")
hist((C_flux.depth.400$C_avg.400), main ="Fig 8 C Flux depth 400")
# using natural log to Transform the data
hist(log(C_flux.depth.150$C_avg.150), main ="Fig 9 C Flux depth 150 (log)")
hist(log(C_flux.depth.200$C_avg.200), main ="Fig 10 C Flux depth 200 (log)")
hist(log(C_flux.depth.300$C_avg.300), main ="Fig 11 C Flux depth 300 (log)")
hist(log(C_flux.depth.400$C_avg.400), main ="Fig 12 C Flux depth 400 (log)")
# Checking for outliers
par(mfrow=c(1,1))
i = "150"
depth <- c("150", "200", "300", "400")
test.object <- NULL
for (i in depth){
test <- cbind(i,get(paste0("C_flux.depth.", i))[,9])
test.object <- rbind(test.object,test)
}
test.object <- as.data.frame(test.object)
#View(test.object)
boxplot(log(as.numeric(test.object$V2))~test.object$i, main = "Figure", xlab = "Depth (m)", ylab = "log of C-Flux (mg carbon m^-2 day^-1)")
Dsts.test <- rbind(cbind(C_flux.depth.150$C_avg.150))
# Checking for normaility and no outliers in Mass Flux
hist((M_flux.depth.150$M_avg.150), breaks = "FD", main ="Fig 38 M Flux depth 150")
hist((M_flux.depth.200$M_avg.200), breaks = "FD", main ="Fig 39 M Flux depth 200")
hist((M_flux.depth.300$M_avg.300), breaks = "FD", main ="Fig 40 M Flux depth 300")
hist((M_flux.depth.400$M_avg.400), breaks = "FD", main ="Fig 41 M Flux depth 400")
# using natural log to Transform the data
hist(log(M_flux.depth.150$M_avg.150), main ="Fig 42 M Flux depth 150 (log)")
hist(log(M_flux.depth.200$M_avg.200), main ="Fig 43 M Flux depth 200 (log)")
hist(log(M_flux.depth.300$M_avg.300), main ="Fig 44 M Flux depth 300 (log)")
hist(log(M_flux.depth.400$M_avg.400), main ="Fig 45 M Flux depth 400 (log)")
# Checking for outliers
par(mfrow=c(1,1))
i = "150"
depth <- c("150", "200", "300", "400")
test.object <- NULL
for (i in depth){
test <- cbind(i,get(paste0("M_flux.depth.", i))[,9])
test.object <- rbind(test.object,test)
}
test.object <- as.data.frame(test.object)
#View(test.object)
boxplot(log(as.numeric(test.object$V2))~test.object$i, main = "Figure 8", xlab = "Depth (m)", ylab = "log of M-Flux (mg mass m^-2 day^-1)"))
# Checking for normaility and no outliers in Mass Flux
hist((M_flux.depth.150$M_avg.150), breaks = "FD", main ="Fig 38 M Flux depth 150")
hist((M_flux.depth.200$M_avg.200), breaks = "FD", main ="Fig 39 M Flux depth 200")
hist((M_flux.depth.300$M_avg.300), breaks = "FD", main ="Fig 40 M Flux depth 300")
hist((M_flux.depth.400$M_avg.400), breaks = "FD", main ="Fig 41 M Flux depth 400")
# using natural log to Transform the data
hist(log(M_flux.depth.150$M_avg.150), main ="Fig 42 M Flux depth 150 (log)")
hist(log(M_flux.depth.200$M_avg.200), main ="Fig 43 M Flux depth 200 (log)")
hist(log(M_flux.depth.300$M_avg.300), main ="Fig 44 M Flux depth 300 (log)")
hist(log(M_flux.depth.400$M_avg.400), main ="Fig 45 M Flux depth 400 (log)")
# Checking for outliers
par(mfrow=c(1,1))
i = "150"
depth <- c("150", "200", "300", "400")
test.object <- NULL
for (i in depth){
test <- cbind(i,get(paste0("M_flux.depth.", i))[,9])
test.object <- rbind(test.object,test)
}
test.object <- as.data.frame(test.object)
#View(test.object)
boxplot(log(as.numeric(test.object$V2))~test.object$i, main = "Figure 8", xlab = "Depth (m)", ylab = "log of M-Flux (mg mass m^-2 day^-1)")
Dsts.test <- rbind(cbind(M_flux.depth.150$M_avg.150))
# Checking for normaility and no outliers in Phosporous Flux
par(mfrow=c(1,3))
hist((P_flux.depth.150$P_avg.150), breaks = "FD", main ="Fig 29 P Flux depth 150")
hist((P_flux.depth.200$P_avg.200), breaks = "FD", main ="Fig 30 P Flux depth 200")
hist((P_flux.depth.300$P_avg.300), breaks = "FD", main ="Fig 31 P Flux depth 300")
# using natural log to Transform the data
par(mfrow=c(1,3))
hist(log(P_flux.depth.150$P_avg.150), main ="Fig 32 P Flux depth 150 (log)")
hist(log(P_flux.depth.200$P_avg.200), main ="Fig 33 P Flux depth 200 (log)")
hist(log(P_flux.depth.300$P_avg.300), main ="Fig 34 P Flux depth 300 (log)")
# Checking for outliers
par(mfrow=c(1,1))
i = "150"
depth <- c("150", "200", "300")
test.object <- NULL
for (i in depth){
test <- cbind(i,get(paste0("P_flux.depth.", i))[,9])
test.object <- rbind(test.object,test)
}
test.object <- as.data.frame(test.object)
#View(test.object)
boxplot(log(as.numeric(test.object$V2))~test.object$i, main = "Figure 7", xlab = "Depth (m)", ylab = "log of P-Flux (mg phosphorous m^-2 day^-1)")
Dsts.test <- rbind(cbind(P_flux.depth.150$P_avg.150))
# Checking for normaility and no outliers in Nitrogen Flux
hist((N_flux.depth.150$N_avg.150), breaks = "FD", main ="Fig 17 N Flux depth 150")
hist((N_flux.depth.200$N_avg.200), breaks = "FD", main ="Fig 18 N Flux depth 200")
hist((N_flux.depth.300$N_avg.300), breaks = "FD", main ="Fig 19 N Flux depth 300")
hist((N_flux.depth.400$N_avg.400), breaks = "FD", main ="Fig 20 N Flux depth 400")
# using natural log to Transform the data
hist(log(N_flux.depth.150$N_avg.150), main ="Fig 21 N Flux depth 150 (log)")
hist(log(N_flux.depth.200$N_avg.200), main ="Fig 22 N Flux depth 200 (log)")
hist(log(N_flux.depth.300$N_avg.300), main ="Fig 23 N Flux depth 300 (log)")
hist(log(N_flux.depth.400$N_avg.400), main ="Fig 24 N Flux depth 400 (log)")
# Checking for outliers
par(mfrow=c(1,1))
i = "150"
depth <- c("150", "200", "300", "400")
test.object <- NULL
for (i in depth){
test <- cbind(i,get(paste0("N_flux.depth.", i))[,9])
test.object <- rbind(test.object,test)
}
test.object <- as.data.frame(test.object)
#View(test.object)
boxplot(log(as.numeric(test.object$V2))~test.object$i, main = "Figure 6", xlab = "Depth (m)", ylab = "log of N-Flux (mg nitrogen m^-2 day^-1)")
Dsts.test <- rbind(cbind(N_flux.depth.150$N_avg.150))
# Checking for normaility and no outliers in Carbon Flux
hist((C_flux.depth.150$C_avg.150), main ="Fig 5 C Flux depth 150")
hist((C_flux.depth.200$C_avg.200), main ="Fig 6 C Flux depth 200")
hist((C_flux.depth.300$C_avg.300), main ="Fig 7 C Flux depth 300")
hist((C_flux.depth.400$C_avg.400), main ="Fig 8 C Flux depth 400")
# using natural log to Transform the data
hist(log(C_flux.depth.150$C_avg.150), main ="Fig 9 C Flux depth 150 (log)")
hist(log(C_flux.depth.200$C_avg.200), main ="Fig 10 C Flux depth 200 (log)")
hist(log(C_flux.depth.300$C_avg.300), main ="Fig 11 C Flux depth 300 (log)")
hist(log(C_flux.depth.400$C_avg.400), main ="Fig 12 C Flux depth 400 (log)")
# Checking for outliers
par(mfrow=c(1,1))
i = "150"
depth <- c("150", "200", "300", "400")
test.object <- NULL
for (i in depth){
test <- cbind(i,get(paste0("C_flux.depth.", i))[,9])
test.object <- rbind(test.object,test)
}
test.object <- as.data.frame(test.object)
#View(test.object)
boxplot(log(as.numeric(test.object$V2))~test.object$i, main = "Figure 5", xlab = "Depth (m)", ylab = "log of C-Flux (mg carbon m^-2 day^-1)")
Dsts.test <- rbind(cbind(C_flux.depth.150$C_avg.150))
#check distribution of D (difference between paried depth samples)
# Carbon
par(mfrow=c(1,3))
hist(C.depth.150.200$D, breaks = "FD", main = "Fig 9 C.depth.150.200$D")
hist(log(C.depth.150.200$D), breaks = "FD", main ="Fig 10 C.depth.150.200$D_bar") #try lo transform
boxplot(log(C.depth.150.200$D), main = "Fig 11") #lots of outliers
#check distribution of D (difference between paried depth samples)
# Carbon
par(mfrow=c(1,3))
hist(C.depth.150.200$D, breaks = "FD", main = "Fig 9 C.depth.150.200$D")
hist(log(C.depth.150.200$D), breaks = "FD", main ="Fig 10 C.depth.150.200$D_bar") #try lo transform
boxplot(log(C.depth.150.200$D), main = "Fig 11 C.depth.150.200$D") #lots of outliers
# Carbon
par(mfrow=c(1,3))
hist(C.depth.200.300$D, breaks = "FD", main = "Fig 12 C.depth.200.300$D")
hist(log(C.depth.200.300$D), breaks = "FD", main ="Fig 13 C.depth.200.300$D_bar") #try lo transform
boxplot(log(C.depth.200.300$D), main ="Fig 14 C.depth.200.300$D") #lots of outliers
# Nitrogen
par(mfrow=c(1,3))
hist(N.depth.150.200$D, breaks = "FD", main ="Fig 15 N.depth.150.200$D_bar")
hist(log(N.depth.150.200$D), breaks = "FD", main ="Fig 16 N.depth.150.200$D_bar") #try lo transform
boxplot(log(N.depth.150.200$D), main = "Fig 17 N.depth.150.200$D") #lots of outliers
# Nitrogen
par(mfrow=c(1,3))
hist(N.depth.200.300$D, breaks = "FD", main = "Fig 17 N.depth.200.300$D")
hist(log(N.depth.200.300$D), breaks = "FD", main ="Fig 18 N.depth.200.300$D_bar") #try lo transform
boxplot(log(N.depth.200.300$D), main = "Fig 19 N.depth.200.300$D") #lots of outliers
# Phosphorous
par(mfrow=c(1,3))
hist(P.depth.150.200$D, breaks = "FD", main ="Fig 20 P.depth.150.200$D_bar")
hist(log(P.depth.150.200$D), breaks = "FD", main ="Fig 21 P.depth.150.200$D_bar") #try lo transform
boxplot(log(P.depth.150.200$D), main ="Fig 22 P.depth.150.200$D_bar") #lots of outliers
# Phosporous
par(mfrow=c(1,3))
hist(P.depth.200.300$D, breaks = "FD", main ="Fig 23 P.depth.200.300$D_bar")
hist(log(P.depth.200.300$D), breaks = "FD", main ="Fig 24 P.depth.200.300$D_bar") #try lo transform
boxplot(log(P.depth.200.300$D), main ="Fig 25 P.depth.200.300$D_bar") #lots of outliers
# Mass
par(mfrow=c(1,3))
hist(M.depth.150.200$D, breaks = "FD", main ="Fig 25 M.depth.150.200$D_bar")
hist(log(M.depth.150.200$D), breaks = "FD", main ="Fig 26 M.depth.150.200$D_bar") #try lo transform
boxplot(log(M.depth.150.200$D), main ="Fig 27 M.depth.150.200$D_bar") #lots of outliers
# Mass
par(mfrow=c(1,3))
hist(M.depth.200.300$D, breaks = "FD", main ="Fig 28 M.depth.200.300$D_bar")
hist(log(M.depth.200.300$D), breaks = "FD", main ="Fig 29 M.depth.200.300$D_bar") #try lo transform
boxplot(log(M.depth.200.300$D), main ="Fig 30 M.depth.200.300$D_bar") #lots of outliers
# plotting each nutrient flux against mass flux
#plot(Data.noNA) # we see some relationships between mass flux and the rest of the nutrient fluxes
par(mfrow=c(1,3))
plot(log(Data.noNA$C_avg),log(Data.noNA$M_avg), main ="Fig 31 M v. C") #good linearity, but clumping
lmfit_C.M <- lm(log(M_avg) ~ log(C_avg), data = Data.noNA)
summary(lmfit_C.M)
abline(lmfit_C.M)
plot(log(Data.noNA$N_avg),log(Data.noNA$M_avg), main ="Fig 32 M v. N") # alright linearity, still clumping
lmfit_N.M <- lm(log(M_avg) ~ log(N_avg), data = Data.noNA)
summary(lmfit_N.M)
abline(lmfit_N.M)
plot(log(Data.noNA$P_avg),log(Data.noNA$M_avg), main ="Fig 33 M v. P") # worse, still clumping
lmfit_P.M <- lm(log(M_avg) ~ log(P_avg), data = Data.noNA)
summary(lmfit_P.M)
abline(lmfit_P.M)
#Carbon EDA
resids <- resid( lmfit_C.M ) # extract epsilon_hats
fit <- fitted ( lmfit_C.M ) # extract y_hats
par(mfrow=c(1,2))
hist(resids, breaks=20, main = "Fig 34")
qqnorm(resids)
qqline(resids, main = "Fig 35") # add straight line from true normal
plot(resids, main="Fig 36 resid vs i")
abline(h=0) # mean of epsilon_hat
plot(x=fit, y=resids, main="Fig 37 resid vs y_hat")
abline(h=0)
#Carbon EDA
resids <- resid( lmfit_C.M ) # extract epsilon_hats
fit <- fitted ( lmfit_C.M ) # extract y_hats
par(mfrow=c(1,2))
hist(resids, breaks=20, main = "Fig 34")
qqnorm(resids)
qqline(resids) # add straight line from true normal
plot(resids, main="Fig 35 resid vs i")
abline(h=0) # mean of epsilon_hat
plot(x=fit, y=resids, main="Fig 36 resid vs y_hat")
abline(h=0)
#Nitrogen EDA
resids <- resid( lmfit_N.M ) # extract epsilon_hats
fit <- fitted ( lmfit_N.M ) # extract y_hats
par(mfrow=c(1,2))
hist(resids, breaks=20, main = "Fig 37")
qqnorm(resids)
qqline(resids) # add straight line from true normal
plot(resids, main="Fig 38 resid vs i")
abline(h=0) # mean of epsilon_hat
plot(x=fit, y=resids, main="Fig 39 resid vs y_hat")
abline(h=0)
#Phosphorus EDA
resids <- resid( lmfit_P.M ) # extract epsilon_hats
fit <- fitted ( lmfit_P.M ) # extract y_hats
par(mfrow=c(1,2))
hist(resids, breaks=20, main = "Fig 40")
qqnorm(resids)
qqline(resids) # add straight line from true normal
plot(resids, main="Fig 41 resid vs i")
abline(h=0) # mean of epsilon_hat
plot(x=fit, y=resids, main="Fig 42 resid vs y_hat")
abline(h=0)
#Collinearity??
plot(Data.noNA) # we see collinearity between Carbon and Nitrogen
Data.noNA$flux <- Data.noNA$C_avg - Data.noNA$N_avg  #combine the fluxes
lmfit.flux <- lm(log(M_avg) ~ log(flux),
data=Data.noNA)
summary(lmfit.flux)
plot(log(Data.noNA$flux), log(Data.noNA$M_avg), main ="Fig 67")
abline(lmfit.flux)
resids <- resid( lmfit.flux ) # extract epsilon_hats
fit <- fitted ( lmfit.flux ) # extract y_hats
par(mfrow=c(1,2))
hist(resids, breaks=20, main ="Fig 43")
qqnorm(resids)
qqline(resids) # add straight line from true normal
plot(resids, main="Fig 44 resid vs i")
abline(h=0) # mean of epsilon_hat
plot(x=fit, y=resids, main="Fig 45 resid vs y_hat")
abline(h=0)
#Collinearity??
plot(Data.noNA) # we see collinearity between Carbon and Nitrogen
Data.noNA$flux <- Data.noNA$C_avg - Data.noNA$N_avg  #combine the fluxes
lmfit.flux <- lm(log(M_avg) ~ log(flux),
data=Data.noNA)
summary(lmfit.flux)
plot(log(Data.noNA$flux), log(Data.noNA$M_avg), main ="Fig 43")
abline(lmfit.flux)
resids <- resid( lmfit.flux ) # extract epsilon_hats
fit <- fitted ( lmfit.flux ) # extract y_hats
par(mfrow=c(1,2))
hist(resids, breaks=20, main ="Fig 44")
qqnorm(resids)
qqline(resids) # add straight line from true normal
plot(resids, main="Fig 45 resid vs i")
abline(h=0) # mean of epsilon_hat
plot(x=fit, y=resids, main="Fig 46 resid vs y_hat")
abline(h=0)
# dept v. C_avg
par(mfrow=c(1,4))
plot(Data.noNA$dep, log(Data.noNA$C_avg), main ="Fig 47")
lmfit_Dep.C <- lm(log(C_avg) ~ dep, data = Data.noNA)
summary(lmfit_Dep.C)
abline(lmfit_Dep.C)
plot(Data.noNA$dep, log(Data.noNA$N_avg), main= "Fig 48")
lmfit_Dep.N <- lm(log(N_avg) ~ dep, data = Data.noNA)
summary(lmfit_Dep.N)
abline(lmfit_Dep.N)
plot(Data.noNA$dep, log(Data.noNA$P_avg),  main= "Fig 49")
lmfit_Dep.P <- lm(log(P_avg) ~ dep, data = Data.noNA)
summary(lmfit_Dep.P)
abline(lmfit_Dep.P)
plot(Data.noNA$dep, log(Data.noNA$M_avg),  main= "Fig 50")
lmfit_Dep.M <- lm(log(M_avg) ~ dep, data = Data.noNA)
summary(lmfit_Dep.M)
abline(lmfit_Dep.M)
#multiple regression
lmfit.MR <- lm(log(M_avg) ~ log(flux) + dep, data = Data.noNA)
summary(lmfit.MR)
resids <- resid( lmfit.MR ) # extract epsilon_hats
fit <- fitted ( lmfit.MR ) # extract y_hats
par(mfrow=c(1,2))
hist(resids, breaks=20,  main= "Fig 51")
qqnorm(resids)
qqline(resids) # add straight line from true normal
plot(resids, main="Fig 52 resid vs i")
abline(h=0) # mean of epsilon_hat
plot(x=fit, y=resids, main="Fig 53 resid vs y_hat")
abline(h=0)
#we want to make predictions on the Mass average flux.
# we want to compare this against depth and C,N,P fluxes
# Depth is categorical
# N,P,C are numerical
library(psych) # for `pairs.panels()`
library(lattice)
ANOCOVA.data <- subset(Data.noNA, select = c("dep", "M_avg", "C_avg","N_avg","P_avg"))
attach(ANOCOVA.data)
summary(ANOCOVA.data)
pairs.panels(data.frame(as.factor(dep),log(C_avg),log(N_avg),log(P_avg),log(M_avg)), main = "Fig 77")
xyplot(log(M_avg) ~ log(C_avg) | as.factor(dep),
main="Fig 54: Activity level-specific scatterplots"
)
xyplot(log(M_avg) ~ log(C_avg), groups=as.factor(dep),
auto.key=TRUE,
main="Fig 55: Scatterplot with color=group level"
)
xyplot(log(M_avg) ~ log(C_avg), groups=as.factor(dep),
type=c("p","r"), # `p` for _points_, `r` for _regression line_
# see https://stackoverflow.com/questions/12972039/plotting-xyplot-with-regression-line-on-lattice-graphics for more
auto.key=TRUE,
main="Fig 80: Three standalone depth level-specific `lm()` fits"
)
#we want to make predictions on the Mass average flux.
# we want to compare this against depth and C,N,P fluxes
# Depth is categorical
# N,P,C are numerical
library(psych) # for `pairs.panels()`
library(lattice)
ANOCOVA.data <- subset(Data.noNA, select = c("dep", "M_avg", "C_avg","N_avg","P_avg"))
attach(ANOCOVA.data)
summary(ANOCOVA.data)
pairs.panels(data.frame(as.factor(dep),log(C_avg),log(N_avg),log(P_avg),log(M_avg)), main = "Fig 77")
xyplot(log(M_avg) ~ log(C_avg) | as.factor(dep),
main="Fig 54: Activity level-specific scatterplots"
)
xyplot(log(M_avg) ~ log(C_avg), groups=as.factor(dep),
auto.key=TRUE,
main="Fig 55: Scatterplot with color=group level"
)
xyplot(log(M_avg) ~ log(C_avg), groups=as.factor(dep),
type=c("p","r"), # `p` for _points_, `r` for _regression line_
# see https://stackoverflow.com/questions/12972039/plotting-xyplot-with-regression-line-on-lattice-graphics for more
auto.key=TRUE,
main="Fig 56: Three standalone depth level-specific `lm()` fits"
)
#we want to make predictions on the Mass average flux.
# we want to compare this against depth and C,N,P fluxes
# Depth is categorical
# N,P,C are numerical
library(psych) # for `pairs.panels()`
library(lattice)
ANOCOVA.data <- subset(Data.noNA, select = c("dep", "M_avg", "C_avg","N_avg","P_avg"))
attach(ANOCOVA.data)
summary(ANOCOVA.data)
pairs.panels(data.frame(as.factor(dep),log(C_avg),log(N_avg),log(P_avg),log(M_avg)), main = "Fig 54")
xyplot(log(M_avg) ~ log(C_avg) | as.factor(dep),
main="Fig 55: Activity level-specific scatterplots"
)
xyplot(log(M_avg) ~ log(C_avg), groups=as.factor(dep),
auto.key=TRUE,
main="Fig 56: Scatterplot with color=group level"
)
xyplot(log(M_avg) ~ log(C_avg), groups=as.factor(dep),
type=c("p","r"), # `p` for _points_, `r` for _regression line_
# see https://stackoverflow.com/questions/12972039/plotting-xyplot-with-regression-line-on-lattice-graphics for more
auto.key=TRUE,
main="Fig 57: Three standalone depth level-specific `lm()` fits"
)
#ANCOVA
ANOCOVA.data <- subset(Data.noNA, select = c("dep", "M_avg", "C_avg","N_avg","P_avg", "Year", "month"))
ANOCOVA.data <- as.vector(ANOCOVA.data)
ANCOVA <- lm(log(M_avg) ~ log(C_avg) + log(N_avg) + log(P_avg) + dep + as.factor(Year) + as.factor(month),data = ANOCOVA.data)
summary(ANCOVA)
plot(ANCOVA)
resids <- resid(ANCOVA)
fit <-fitted(ANCOVA)
