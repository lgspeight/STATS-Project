boxplot(log(C_flux.depth.200$C_avg.200))
boxplot(log(C_flux.depth.300$C_avg.300))
boxplot(log(C_flux.depth.400$C_avg.400))
# Checking for normaility and no outliers in Nitrogen Flux
par(mfrow=c(1,4))
hist((N_flux.depth.150$N_avg.150), breaks = "FD")
hist((N_flux.depth.200$N_avg.200), breaks = "FD")
hist((N_flux.depth.300$N_avg.300), breaks = "FD")
hist((N_flux.depth.400$N_avg.400), breaks = "FD")
# using natural log to Transform the data
par(mfrow=c(1,4))
hist(log(N_flux.depth.150$N_avg.150))
hist(log(N_flux.depth.200$N_avg.200))
hist(log(N_flux.depth.300$N_avg.300))
hist(log(N_flux.depth.400$N_avg.400))
# Checking for outliers
par(mfrow=c(1,4))
boxplot(log(N_flux.depth.150$N_avg.150))
boxplot(log(N_flux.depth.200$N_avg.200))
boxplot(log(N_flux.depth.300$N_avg.300))
boxplot(log(N_flux.depth.400$N_avg.400))
# Checking for normaility and no outliers in Phosporous Flux
par(mfrow=c(1,3))
hist((P_flux.depth.150$P_avg.150), breaks = "FD")
hist((P_flux.depth.200$P_avg.200), breaks = "FD")
hist((P_flux.depth.300$P_avg.300), breaks = "FD")
# using natural log to Transform the data
par(mfrow=c(1,3))
hist(log(P_flux.depth.150$P_avg.150))
hist(log(P_flux.depth.200$P_avg.200))
hist(log(P_flux.depth.300$P_avg.300))
# Checking for outliers
par(mfrow=c(1,3))
boxplot(log(P_flux.depth.150$P_avg.150))
boxplot(log(P_flux.depth.200$P_avg.200))
boxplot(log(P_flux.depth.300$P_avg.300))
#create D-bar for each paired group
C.depth.150.200 <- merge(C_flux.depth.150,C_flux.depth.200,by = c("cr","yymmdd1","yymmdd2","Lat2","Lat2.1","Long1","Long2"))
C.depth.150.200$D_bar <- C.depth.150.200$C_avg.150 - C.depth.150.200$C_avg.200
C.depth.200.300 <- merge(C_flux.depth.200,C_flux.depth.300,by = c("cr","yymmdd1","yymmdd2","Lat2","Lat2.1","Long1","Long2"))
C.depth.200.300$D_bar <- C.depth.200.300$C_avg.200 - C.depth.200.300$C_avg.300
N.depth.150.200 <- merge(N_flux.depth.150,N_flux.depth.200,by = c("cr","yymmdd1","yymmdd2","Lat2","Lat2.1","Long1","Long2"))
N.depth.150.200$D_bar <- N.depth.150.200$N_avg.150 - N.depth.150.200$N_avg.200
N.depth.200.300 <- merge(N_flux.depth.200,N_flux.depth.300,by = c("cr","yymmdd1","yymmdd2","Lat2","Lat2.1","Long1","Long2"))
N.depth.200.300$D_bar <- N.depth.200.300$N_avg.200 - N.depth.200.300$N_avg.300
P.depth.150.200 <- merge(P_flux.depth.150,P_flux.depth.200,by = c("cr","yymmdd1","yymmdd2","Lat2","Lat2.1","Long1","Long2"))
P.depth.150.200$D_bar <- P.depth.150.200$P_avg.150 - P.depth.150.200$P_avg.200
P.depth.200.300 <- merge(P_flux.depth.200,P_flux.depth.300,by = c("cr","yymmdd1","yymmdd2","Lat2","Lat2.1","Long1","Long2"))
P.depth.200.300$D_bar <- P.depth.200.300$P_avg.200 - P.depth.200.300$P_avg.300
M.depth.150.200 <- merge(M_flux.depth.150,M_flux.depth.200,by = c("cr","yymmdd1","yymmdd2","Lat2","Lat2.1","Long1","Long2"))
M.depth.150.200$D_bar <- M.depth.150.200$M_avg.150 - M.depth.150.200$M_avg.200
M.depth.200.300 <- merge(M_flux.depth.200,M_flux.depth.300,by = c("cr","yymmdd1","yymmdd2","Lat2","Lat2.1","Long1","Long2"))
M.depth.200.300$D_bar <- M.depth.200.300$M_avg.200 - M.depth.200.300$M_avg.300
#check distribution of D-bar (difference between paried depth samples)
# Carbon
par(mfrow=c(1,3))
hist(C.depth.150.200$D_bar, breaks = "FD")
hist(log(C.depth.150.200$D_bar), breaks = "FD") #try lo transform
boxplot(log(C.depth.150.200$D_bar)) #lots of outliers
par(mfrow=c(1,3))
hist(C.depth.200.300$D_bar, breaks = "FD")
hist(log(C.depth.200.300$D_bar), breaks = "FD") #try lo transform
boxplot(log(C.depth.200.300$D_bar)) #lots of outliers
# Nitrogen
par(mfrow=c(1,3))
hist(N.depth.150.200$D_bar, breaks = "FD")
hist(log(N.depth.150.200$D_bar), breaks = "FD") #try lo transform
boxplot(log(N.depth.150.200$D_bar)) #lots of outliers
par(mfrow=c(1,3))
hist(N.depth.200.300$D_bar, breaks = "FD")
hist(log(N.depth.200.300$D_bar), breaks = "FD") #try lo transform
boxplot(log(N.depth.200.300$D_bar)) #lots of outliers
# Phosphorous
par(mfrow=c(1,3))
hist(P.depth.150.200$D_bar, breaks = "FD")
hist(log(P.depth.150.200$D_bar), breaks = "FD") #try lo transform
boxplot(log(P.depth.150.200$D_bar)) #lots of outliers
par(mfrow=c(1,3))
hist(P.depth.200.300$D_bar, breaks = "FD")
hist(log(P.depth.200.300$D_bar), breaks = "FD") #try lo transform
boxplot(log(P.depth.200.300$D_bar)) #lots of outliers
# Mass
par(mfrow=c(1,3))
hist(M.depth.150.200$D_bar, breaks = "FD")
hist(log(M.depth.150.200$D_bar), breaks = "FD") #try lo transform
boxplot(log(M.depth.150.200$D_bar)) #lots of outliers
par(mfrow=c(1,3))
hist(M.depth.200.300$D_bar, breaks = "FD")
hist(log(M.depth.200.300$D_bar), breaks = "FD") #try lo transform
boxplot(log(M.depth.200.300$D_bar)) #lots of outliers
#create D-bar for each paired group
C.depth.150.200 <- merge(C_flux.depth.150,C_flux.depth.200,by = c("cr","yymmdd1","yymmdd2","Lat2","Lat2.1","Long1","Long2"))
C.depth.150.200$D_bar <- C.depth.150.200$C_avg.150 - C.depth.150.200$C_avg.200
C.depth.200.300 <- merge(C_flux.depth.200,C_flux.depth.300,by = c("cr","yymmdd1","yymmdd2","Lat2","Lat2.1","Long1","Long2"))
C.depth.200.300$D_bar <- C.depth.200.300$C_avg.200 - C.depth.200.300$C_avg.300
N.depth.150.200 <- merge(N_flux.depth.150,N_flux.depth.200,by = c("cr","yymmdd1","yymmdd2","Lat2","Lat2.1","Long1","Long2"))
N.depth.150.200$D_bar <- N.depth.150.200$N_avg.150 - N.depth.150.200$N_avg.200
N.depth.200.300 <- merge(N_flux.depth.200,N_flux.depth.300,by = c("cr","yymmdd1","yymmdd2","Lat2","Lat2.1","Long1","Long2"))
N.depth.200.300$D_bar <- N.depth.200.300$N_avg.200 - N.depth.200.300$N_avg.300
P.depth.150.200 <- merge(P_flux.depth.150,P_flux.depth.200,by = c("cr","yymmdd1","yymmdd2","Lat2","Lat2.1","Long1","Long2"))
P.depth.150.200$D_bar <- P.depth.150.200$P_avg.150 - P.depth.150.200$P_avg.200
P.depth.200.300 <- merge(P_flux.depth.200,P_flux.depth.300,by = c("cr","yymmdd1","yymmdd2","Lat2","Lat2.1","Long1","Long2"))
P.depth.200.300$D_bar <- P.depth.200.300$P_avg.200 - P.depth.200.300$P_avg.300
M.depth.150.200 <- merge(M_flux.depth.150,M_flux.depth.200,by = c("cr","yymmdd1","yymmdd2","Lat2","Lat2.1","Long1","Long2"))
M.depth.150.200$D_bar <- M.depth.150.200$M_avg.150 - M.depth.150.200$M_avg.200
M.depth.200.300 <- merge(M_flux.depth.200,M_flux.depth.300,by = c("cr","yymmdd1","yymmdd2","Lat2","Lat2.1","Long1","Long2"))
M.depth.200.300$D_bar <- M.depth.200.300$M_avg.200 - M.depth.200.300$M_avg.300
D_bar <- data.frame(c("dep150.200","dep200.300"), c(C.depth.150.200$D_bar, C.depth.200.300$D_bar), c(N.depth.150.200$D_bar, N.depth.200.300$D_bar), c(P.depth.150.200$D_bar, P.depth.200.300$D_bar), C(M.depth.150.200$D_bar, M.depth.200.300$D_bar))
#create D-bar for each paired group
C.depth.150.200 <- merge(C_flux.depth.150,C_flux.depth.200,by = c("cr","yymmdd1","yymmdd2","Lat2","Lat2.1","Long1","Long2"))
C.depth.150.200$D_bar <- C.depth.150.200$C_avg.150 - C.depth.150.200$C_avg.200
C.depth.200.300 <- merge(C_flux.depth.200,C_flux.depth.300,by = c("cr","yymmdd1","yymmdd2","Lat2","Lat2.1","Long1","Long2"))
C.depth.200.300$D_bar <- C.depth.200.300$C_avg.200 - C.depth.200.300$C_avg.300
N.depth.150.200 <- merge(N_flux.depth.150,N_flux.depth.200,by = c("cr","yymmdd1","yymmdd2","Lat2","Lat2.1","Long1","Long2"))
N.depth.150.200$D_bar <- N.depth.150.200$N_avg.150 - N.depth.150.200$N_avg.200
N.depth.200.300 <- merge(N_flux.depth.200,N_flux.depth.300,by = c("cr","yymmdd1","yymmdd2","Lat2","Lat2.1","Long1","Long2"))
N.depth.200.300$D_bar <- N.depth.200.300$N_avg.200 - N.depth.200.300$N_avg.300
P.depth.150.200 <- merge(P_flux.depth.150,P_flux.depth.200,by = c("cr","yymmdd1","yymmdd2","Lat2","Lat2.1","Long1","Long2"))
P.depth.150.200$D_bar <- P.depth.150.200$P_avg.150 - P.depth.150.200$P_avg.200
P.depth.200.300 <- merge(P_flux.depth.200,P_flux.depth.300,by = c("cr","yymmdd1","yymmdd2","Lat2","Lat2.1","Long1","Long2"))
P.depth.200.300$D_bar <- P.depth.200.300$P_avg.200 - P.depth.200.300$P_avg.300
M.depth.150.200 <- merge(M_flux.depth.150,M_flux.depth.200,by = c("cr","yymmdd1","yymmdd2","Lat2","Lat2.1","Long1","Long2"))
M.depth.150.200$D_bar <- M.depth.150.200$M_avg.150 - M.depth.150.200$M_avg.200
M.depth.200.300 <- merge(M_flux.depth.200,M_flux.depth.300,by = c("cr","yymmdd1","yymmdd2","Lat2","Lat2.1","Long1","Long2"))
M.depth.200.300$D_bar <- M.depth.200.300$M_avg.200 - M.depth.200.300$M_avg.300
D_bar <- data.frame(c("dep150.200","dep200.300"), c(C.depth.150.200$D_bar, C.depth.200.300$D_bar), c(N.depth.150.200$D_bar, N.depth.200.300$D_bar), c(P.depth.150.200$D_bar, P.depth.200.300$D_bar), c(M.depth.150.200$D_bar, M.depth.200.300$D_bar))
#create D-bar for each paired group
C.depth.150.200 <- merge(C_flux.depth.150,C_flux.depth.200,by = c("cr","yymmdd1","yymmdd2","Lat2","Lat2.1","Long1","Long2"))
C.depth.150.200$D_bar <- C.depth.150.200$C_avg.150 - C.depth.150.200$C_avg.200
C.depth.200.300 <- merge(C_flux.depth.200,C_flux.depth.300,by = c("cr","yymmdd1","yymmdd2","Lat2","Lat2.1","Long1","Long2"))
C.depth.200.300$D_bar <- C.depth.200.300$C_avg.200 - C.depth.200.300$C_avg.300
N.depth.150.200 <- merge(N_flux.depth.150,N_flux.depth.200,by = c("cr","yymmdd1","yymmdd2","Lat2","Lat2.1","Long1","Long2"))
N.depth.150.200$D_bar <- N.depth.150.200$N_avg.150 - N.depth.150.200$N_avg.200
N.depth.200.300 <- merge(N_flux.depth.200,N_flux.depth.300,by = c("cr","yymmdd1","yymmdd2","Lat2","Lat2.1","Long1","Long2"))
N.depth.200.300$D_bar <- N.depth.200.300$N_avg.200 - N.depth.200.300$N_avg.300
P.depth.150.200 <- merge(P_flux.depth.150,P_flux.depth.200,by = c("cr","yymmdd1","yymmdd2","Lat2","Lat2.1","Long1","Long2"))
P.depth.150.200$D_bar <- P.depth.150.200$P_avg.150 - P.depth.150.200$P_avg.200
P.depth.200.300 <- merge(P_flux.depth.200,P_flux.depth.300,by = c("cr","yymmdd1","yymmdd2","Lat2","Lat2.1","Long1","Long2"))
P.depth.200.300$D_bar <- P.depth.200.300$P_avg.200 - P.depth.200.300$P_avg.300
M.depth.150.200 <- merge(M_flux.depth.150,M_flux.depth.200,by = c("cr","yymmdd1","yymmdd2","Lat2","Lat2.1","Long1","Long2"))
M.depth.150.200$D_bar <- M.depth.150.200$M_avg.150 - M.depth.150.200$M_avg.200
M.depth.200.300 <- merge(M_flux.depth.200,M_flux.depth.300,by = c("cr","yymmdd1","yymmdd2","Lat2","Lat2.1","Long1","Long2"))
M.depth.200.300$D_bar <- M.depth.200.300$M_avg.200 - M.depth.200.300$M_avg.300
D_bar.mean <- data.frame(c("dep150.200","dep200.300"), c(mean(C.depth.150.200$D_bar, C.depth.200.300$D_bar)), c(mean(N.depth.150.200$D_bar, N.depth.200.300$D_bar)), c(mean(P.depth.150.200$D_bar, P.depth.200.300$D_bar)), c(mean(M.depth.150.200$D_bar, M.depth.200.300$D_bar))
colnames(D_bar)[1] <- "Depth.Compare"
#create D-bar for each paired group
C.depth.150.200 <- merge(C_flux.depth.150,C_flux.depth.200,by = c("cr","yymmdd1","yymmdd2","Lat2","Lat2.1","Long1","Long2"))
C.depth.150.200$D_bar <- C.depth.150.200$C_avg.150 - C.depth.150.200$C_avg.200
C.depth.200.300 <- merge(C_flux.depth.200,C_flux.depth.300,by = c("cr","yymmdd1","yymmdd2","Lat2","Lat2.1","Long1","Long2"))
C.depth.200.300$D_bar <- C.depth.200.300$C_avg.200 - C.depth.200.300$C_avg.300
N.depth.150.200 <- merge(N_flux.depth.150,N_flux.depth.200,by = c("cr","yymmdd1","yymmdd2","Lat2","Lat2.1","Long1","Long2"))
N.depth.150.200$D_bar <- N.depth.150.200$N_avg.150 - N.depth.150.200$N_avg.200
N.depth.200.300 <- merge(N_flux.depth.200,N_flux.depth.300,by = c("cr","yymmdd1","yymmdd2","Lat2","Lat2.1","Long1","Long2"))
N.depth.200.300$D_bar <- N.depth.200.300$N_avg.200 - N.depth.200.300$N_avg.300
P.depth.150.200 <- merge(P_flux.depth.150,P_flux.depth.200,by = c("cr","yymmdd1","yymmdd2","Lat2","Lat2.1","Long1","Long2"))
P.depth.150.200$D_bar <- P.depth.150.200$P_avg.150 - P.depth.150.200$P_avg.200
P.depth.200.300 <- merge(P_flux.depth.200,P_flux.depth.300,by = c("cr","yymmdd1","yymmdd2","Lat2","Lat2.1","Long1","Long2"))
P.depth.200.300$D_bar <- P.depth.200.300$P_avg.200 - P.depth.200.300$P_avg.300
M.depth.150.200 <- merge(M_flux.depth.150,M_flux.depth.200,by = c("cr","yymmdd1","yymmdd2","Lat2","Lat2.1","Long1","Long2"))
M.depth.150.200$D_bar <- M.depth.150.200$M_avg.150 - M.depth.150.200$M_avg.200
M.depth.200.300 <- merge(M_flux.depth.200,M_flux.depth.300,by = c("cr","yymmdd1","yymmdd2","Lat2","Lat2.1","Long1","Long2"))
M.depth.200.300$D_bar <- M.depth.200.300$M_avg.200 - M.depth.200.300$M_avg.300
D_bar.mean <- data.frame(c("dep150.200","dep200.300"), c(mean(C.depth.150.200$D_bar), mean(C.depth.200.300$D_bar)), c(mean(N.depth.150.200$D_bar, mean(N.depth.200.300$D_bar)), c(mean(P.depth.150.200$D_bar), mean(P.depth.200.300$D_bar)), c(mean(M.depth.150.200$D_bar), mean(M.depth.200.300$D_bar))))
#create D-bar for each paired group
C.depth.150.200 <- merge(C_flux.depth.150,C_flux.depth.200,by = c("cr","yymmdd1","yymmdd2","Lat2","Lat2.1","Long1","Long2"))
C.depth.150.200$D_bar <- C.depth.150.200$C_avg.150 - C.depth.150.200$C_avg.200
C.depth.200.300 <- merge(C_flux.depth.200,C_flux.depth.300,by = c("cr","yymmdd1","yymmdd2","Lat2","Lat2.1","Long1","Long2"))
C.depth.200.300$D_bar <- C.depth.200.300$C_avg.200 - C.depth.200.300$C_avg.300
N.depth.150.200 <- merge(N_flux.depth.150,N_flux.depth.200,by = c("cr","yymmdd1","yymmdd2","Lat2","Lat2.1","Long1","Long2"))
N.depth.150.200$D_bar <- N.depth.150.200$N_avg.150 - N.depth.150.200$N_avg.200
N.depth.200.300 <- merge(N_flux.depth.200,N_flux.depth.300,by = c("cr","yymmdd1","yymmdd2","Lat2","Lat2.1","Long1","Long2"))
N.depth.200.300$D_bar <- N.depth.200.300$N_avg.200 - N.depth.200.300$N_avg.300
P.depth.150.200 <- merge(P_flux.depth.150,P_flux.depth.200,by = c("cr","yymmdd1","yymmdd2","Lat2","Lat2.1","Long1","Long2"))
P.depth.150.200$D_bar <- P.depth.150.200$P_avg.150 - P.depth.150.200$P_avg.200
P.depth.200.300 <- merge(P_flux.depth.200,P_flux.depth.300,by = c("cr","yymmdd1","yymmdd2","Lat2","Lat2.1","Long1","Long2"))
P.depth.200.300$D_bar <- P.depth.200.300$P_avg.200 - P.depth.200.300$P_avg.300
M.depth.150.200 <- merge(M_flux.depth.150,M_flux.depth.200,by = c("cr","yymmdd1","yymmdd2","Lat2","Lat2.1","Long1","Long2"))
M.depth.150.200$D_bar <- M.depth.150.200$M_avg.150 - M.depth.150.200$M_avg.200
M.depth.200.300 <- merge(M_flux.depth.200,M_flux.depth.300,by = c("cr","yymmdd1","yymmdd2","Lat2","Lat2.1","Long1","Long2"))
M.depth.200.300$D_bar <- M.depth.200.300$M_avg.200 - M.depth.200.300$M_avg.300
D_bar.mean <- data.frame(c("dep150.200","dep200.300"), c(mean(C.depth.150.200$D_bar), mean(C.depth.200.300$D_bar)), c(mean(N.depth.150.200$D_bar), mean(N.depth.200.300$D_bar)), c(mean(P.depth.150.200$D_bar), mean(P.depth.200.300$D_bar)), c(mean(M.depth.150.200$D_bar), mean(M.depth.200.300$D_bar)))
colnames(D_bar)[1] <- "Depth.Compare"
#create D-bar for each paired group
C.depth.150.200 <- merge(C_flux.depth.150,C_flux.depth.200,by = c("cr","yymmdd1","yymmdd2","Lat2","Lat2.1","Long1","Long2"))
C.depth.150.200$D_bar <- C.depth.150.200$C_avg.150 - C.depth.150.200$C_avg.200
C.depth.200.300 <- merge(C_flux.depth.200,C_flux.depth.300,by = c("cr","yymmdd1","yymmdd2","Lat2","Lat2.1","Long1","Long2"))
C.depth.200.300$D_bar <- C.depth.200.300$C_avg.200 - C.depth.200.300$C_avg.300
N.depth.150.200 <- merge(N_flux.depth.150,N_flux.depth.200,by = c("cr","yymmdd1","yymmdd2","Lat2","Lat2.1","Long1","Long2"))
N.depth.150.200$D_bar <- N.depth.150.200$N_avg.150 - N.depth.150.200$N_avg.200
N.depth.200.300 <- merge(N_flux.depth.200,N_flux.depth.300,by = c("cr","yymmdd1","yymmdd2","Lat2","Lat2.1","Long1","Long2"))
N.depth.200.300$D_bar <- N.depth.200.300$N_avg.200 - N.depth.200.300$N_avg.300
P.depth.150.200 <- merge(P_flux.depth.150,P_flux.depth.200,by = c("cr","yymmdd1","yymmdd2","Lat2","Lat2.1","Long1","Long2"))
P.depth.150.200$D_bar <- P.depth.150.200$P_avg.150 - P.depth.150.200$P_avg.200
P.depth.200.300 <- merge(P_flux.depth.200,P_flux.depth.300,by = c("cr","yymmdd1","yymmdd2","Lat2","Lat2.1","Long1","Long2"))
P.depth.200.300$D_bar <- P.depth.200.300$P_avg.200 - P.depth.200.300$P_avg.300
M.depth.150.200 <- merge(M_flux.depth.150,M_flux.depth.200,by = c("cr","yymmdd1","yymmdd2","Lat2","Lat2.1","Long1","Long2"))
M.depth.150.200$D_bar <- M.depth.150.200$M_avg.150 - M.depth.150.200$M_avg.200
M.depth.200.300 <- merge(M_flux.depth.200,M_flux.depth.300,by = c("cr","yymmdd1","yymmdd2","Lat2","Lat2.1","Long1","Long2"))
M.depth.200.300$D_bar <- M.depth.200.300$M_avg.200 - M.depth.200.300$M_avg.300
D_bar.mean <- data.frame(c("dep150.200","dep200.300"), c(mean(C.depth.150.200$D_bar), mean(C.depth.200.300$D_bar)), c(mean(N.depth.150.200$D_bar), mean(N.depth.200.300$D_bar)), c(mean(P.depth.150.200$D_bar), mean(P.depth.200.300$D_bar)), c(mean(M.depth.150.200$D_bar), mean(M.depth.200.300$D_bar)))
colnames(D_bar.mean)[1] <- "Depth.Compare"
colnames(D_bar.mean)[2] <- "C_flux"
colnames(D_bar.mean)[3] <- "N_flux"
colnames(D_bar.mean)[4] <- "P_flux"
colnames(D_bar.mean)[5] <- "M_flux"
D_bar.mean
#we want to make predictions on the Mass average flux.
# we want to compare this against depth and C,N,P fluxes
# Depth is categorical
# N,P,C are numerical
library(psych) # for `pairs.panels()`
library(lattice)
ANOCOVA.data <- subset(Data.noNA, select = c("dep", "M_avg", "C_avg","N_avg","P_avg"))
as.character(ANOCOVA.data$dep) # need to make dep categorical not numerical
attach(ANOCOVA.data)
summary(ANOCOVA.data)
pairs.panels(data.frame(dep,C_avg,N_avg, P_avg, M_avg))
xyplot(log(M_avg) ~ log(C_avg) | dep,
main="Fig2a: Activity level-specific scatterplots"
)
xyplot(log(M_avg) ~ log(C_avg), groups=dep,
auto.key=TRUE,
main="Fig2b: Scatterplot with color=group level"
)
xyplot(log(M_avg) ~ log(C_avg), groups=dep,
type=c("p","r"), # `p` for _points_, `r` for _regression line_
# see https://stackoverflow.com/questions/12972039/plotting-xyplot-with-regression-line-on-lattice-graphics for more
auto.key=TRUE,
main="Fig3: Three standalone depth level-specific `lm()` fits"
)
View(C_flux.depth.400)
View(D_bar.mean)
#we want to make predictions on the Mass average flux.
# we want to compare this against depth and C,N,P fluxes
# Depth is categorical
# N,P,C are numerical
library(psych) # for `pairs.panels()`
library(lattice)
ANOCOVA.data <- subset(Data.noNA, select = c("dep", "M_avg", "C_avg","N_avg","P_avg"))
as.character(ANOCOVA.data$dep) # need to make dep categorical not numerical
attach(ANOCOVA.data)
summary(ANOCOVA.data)
pairs.panels(data.frame(dep,log(C_avg),log(N_avg),log(P_avg),log(M_avg)))
xyplot(log(M_avg) ~ log(C_avg) | dep,
main="Fig2a: Activity level-specific scatterplots"
)
xyplot(log(M_avg) ~ log(C_avg), groups=dep,
auto.key=TRUE,
main="Fig2b: Scatterplot with color=group level"
)
xyplot(log(M_avg) ~ log(C_avg), groups=dep,
type=c("p","r"), # `p` for _points_, `r` for _regression line_
# see https://stackoverflow.com/questions/12972039/plotting-xyplot-with-regression-line-on-lattice-graphics for more
auto.key=TRUE,
main="Fig3: Three standalone depth level-specific `lm()` fits"
)
#we want to make predictions on the Mass average flux.
# we want to compare this against depth and C,N,P fluxes
# Depth is categorical
# N,P,C are numerical
library(psych) # for `pairs.panels()`
library(lattice)
ANOCOVA.data <- subset(Data.noNA, select = c("dep", "M_avg", "C_avg","N_avg","P_avg"))
as.character(ANOCOVA.data$dep) # need to make dep categorical not numerical
attach(ANOCOVA.data)
summary(ANOCOVA.data)
pairs.panels(data.frame(as.factor(dep),log(C_avg),log(N_avg),log(P_avg),log(M_avg)))
xyplot(log(M_avg) ~ log(C_avg) | dep,
main="Fig2a: Activity level-specific scatterplots"
)
xyplot(log(M_avg) ~ log(C_avg), groups=dep,
auto.key=TRUE,
main="Fig2b: Scatterplot with color=group level"
)
xyplot(log(M_avg) ~ log(C_avg), groups=dep,
type=c("p","r"), # `p` for _points_, `r` for _regression line_
# see https://stackoverflow.com/questions/12972039/plotting-xyplot-with-regression-line-on-lattice-graphics for more
auto.key=TRUE,
main="Fig3: Three standalone depth level-specific `lm()` fits"
)
#we want to make predictions on the Mass average flux.
# we want to compare this against depth and C,N,P fluxes
# Depth is categorical
# N,P,C are numerical
library(psych) # for `pairs.panels()`
library(lattice)
ANOCOVA.data <- subset(Data.noNA, select = c("dep", "M_avg", "C_avg","N_avg","P_avg"))
as.character(ANOCOVA.data$dep) # need to make dep categorical not numerical
attach(ANOCOVA.data)
summary(ANOCOVA.data)
pairs.panels(data.frame(as.factor(dep),log(C_avg),log(N_avg),log(P_avg),log(M_avg)))
xyplot(log(M_avg) ~ log(C_avg) | as.factor(dep),
main="Fig2a: Activity level-specific scatterplots"
)
xyplot(log(M_avg) ~ log(C_avg), groups=dep,
auto.key=TRUE,
main="Fig2b: Scatterplot with color=group level"
)
xyplot(log(M_avg) ~ log(C_avg), groups=dep,
type=c("p","r"), # `p` for _points_, `r` for _regression line_
# see https://stackoverflow.com/questions/12972039/plotting-xyplot-with-regression-line-on-lattice-graphics for more
auto.key=TRUE,
main="Fig3: Three standalone depth level-specific `lm()` fits"
)
#we want to make predictions on the Mass average flux.
# we want to compare this against depth and C,N,P fluxes
# Depth is categorical
# N,P,C are numerical
library(psych) # for `pairs.panels()`
library(lattice)
ANOCOVA.data <- subset(Data.noNA, select = c("dep", "M_avg", "C_avg","N_avg","P_avg"))
as.character(ANOCOVA.data$dep) # need to make dep categorical not numerical
attach(ANOCOVA.data)
summary(ANOCOVA.data)
pairs.panels(data.frame(as.factor(dep),log(C_avg),log(N_avg),log(P_avg),log(M_avg)))
xyplot(log(M_avg) ~ log(C_avg) | as.factor(dep),
main="Fig2a: Activity level-specific scatterplots"
)
xyplot(log(M_avg) ~ log(C_avg), groups=as.factor(dep),
auto.key=TRUE,
main="Fig2b: Scatterplot with color=group level"
)
xyplot(log(M_avg) ~ log(C_avg), groups=as.factor(dep),
type=c("p","r"), # `p` for _points_, `r` for _regression line_
# see https://stackoverflow.com/questions/12972039/plotting-xyplot-with-regression-line-on-lattice-graphics for more
auto.key=TRUE,
main="Fig3: Three standalone depth level-specific `lm()` fits"
)
lmfit.MR <- lm(M_avg ~ flux + dep, data = Data.noNA)
summary(lmfit.MR)
resids <- resid( lmfit.MR ) # extract epsilon_hats
fit <- fitted ( lmfit.MR ) # extract y_hats
par(mfrow=c(1,2))
hist(resids, breaks=20)
qqnorm(resids)
qqline(resids) # add straight line from true normal
plot(resids, main="resid vs i")
abline(h=0) # mean of epsilon_hat
plot(x=fit, y=resids, main="resid vs y_hat")
abline(h=0)
lmfit.MR <- lm(log(M_avg) ~ flux + dep, data = Data.noNA)
summary(lmfit.MR)
resids <- resid( lmfit.MR ) # extract epsilon_hats
fit <- fitted ( lmfit.MR ) # extract y_hats
par(mfrow=c(1,2))
hist(resids, breaks=20)
qqnorm(resids)
qqline(resids) # add straight line from true normal
plot(resids, main="resid vs i")
abline(h=0) # mean of epsilon_hat
plot(x=fit, y=resids, main="resid vs y_hat")
abline(h=0)
Data.noNA$flux <- Data.noNA$C_avg - Data.noNA$N_avg - Data.noNA$P_avg #combine the fluxes
lmfit.flux <- lm(M_avg ~ flux,
data=Data.noNA)
summary(lmfit.flux)
plot(Data.noNA$flux, Data.noNA$M_avg)
abline(lmfit.flux)
resids <- resid( lmfit.flux ) # extract epsilon_hats
fit <- fitted ( lmfit.flux ) # extract y_hats
par(mfrow=c(1,2))
hist(resids, breaks=20)
qqnorm(resids)
qqline(resids) # add straight line from true normal
plot(resids, main="resid vs i")
abline(h=0) # mean of epsilon_hat
plot(x=fit, y=resids, main="resid vs y_hat")
abline(h=0)
Data.noNA$flux <- Data.noNA$C_avg - Data.noNA$N_avg - Data.noNA$P_avg #combine the fluxes
lmfit.flux <- lm(log(M_avg) ~ flux,
data=Data.noNA)
summary(lmfit.flux)
plot(Data.noNA$flux, Data.noNA$M_avg)
abline(lmfit.flux)
resids <- resid( lmfit.flux ) # extract epsilon_hats
fit <- fitted ( lmfit.flux ) # extract y_hats
par(mfrow=c(1,2))
hist(resids, breaks=20)
qqnorm(resids)
qqline(resids) # add straight line from true normal
plot(resids, main="resid vs i")
abline(h=0) # mean of epsilon_hat
plot(x=fit, y=resids, main="resid vs y_hat")
abline(h=0)
Data.noNA$flux <- Data.noNA$C_avg - Data.noNA$N_avg - Data.noNA$P_avg #combine the fluxes
lmfit.flux <- lm(log(M_avg) ~ log(flux),
data=Data.noNA)
summary(lmfit.flux)
plot(Data.noNA$flux, Data.noNA$M_avg)
abline(lmfit.flux)
resids <- resid( lmfit.flux ) # extract epsilon_hats
fit <- fitted ( lmfit.flux ) # extract y_hats
par(mfrow=c(1,2))
hist(resids, breaks=20)
qqnorm(resids)
qqline(resids) # add straight line from true normal
plot(resids, main="resid vs i")
abline(h=0) # mean of epsilon_hat
plot(x=fit, y=resids, main="resid vs y_hat")
abline(h=0)
lmfit.MR <- lm(log(M_avg) ~ log(flux) + dep, data = Data.noNA)
summary(lmfit.MR)
resids <- resid( lmfit.MR ) # extract epsilon_hats
fit <- fitted ( lmfit.MR ) # extract y_hats
par(mfrow=c(1,2))
hist(resids, breaks=20)
qqnorm(resids)
qqline(resids) # add straight line from true normal
plot(resids, main="resid vs i")
abline(h=0) # mean of epsilon_hat
plot(x=fit, y=resids, main="resid vs y_hat")
abline(h=0)
smaller <- lmfit.flux; larger <- lmfit.MR
anova(smaller, larger)
Data.noNA$flux <- Data.noNA$C_avg - Data.noNA$N_avg - Data.noNA$P_avg #combine the fluxes
lmfit.flux <- lm(log(M_avg) ~ log(flux),
data=Data.noNA)
summary(lmfit.flux)
plot(log(Data.noNA$flux), log(Data.noNA$M_avg))
abline(lmfit.flux)
resids <- resid( lmfit.flux ) # extract epsilon_hats
fit <- fitted ( lmfit.flux ) # extract y_hats
par(mfrow=c(1,2))
hist(resids, breaks=20)
qqnorm(resids)
qqline(resids) # add straight line from true normal
plot(resids, main="resid vs i")
abline(h=0) # mean of epsilon_hat
plot(x=fit, y=resids, main="resid vs y_hat")
abline(h=0)
resids <- resid( lmfit_P.M ) # extract epsilon_hats
fit <- fitted ( lmfit_P.M ) # extract y_hats
par(mfrow=c(1,2))
hist(resids, breaks=20)
qqnorm(resids)
qqline(resids) # add straight line from true normal
plot(resids, main="resid vs i")
abline(h=0) # mean of epsilon_hat
plot(x=fit, y=resids, main="resid vs y_hat")
abline(h=0)
smaller <- lmfit.flux; larger <- lmfit.MR
anova(smaller, larger)
smaller.1 <- lmfit_Dep.M; larger <- lmfit.MR
anova(smaller.1, larger)
ANOCOVA.data <- subset(Data.noNA, select = c("dep", "M_avg", "C_avg","N_avg","P_avg", "Year", "month"))
ANOCOVA.data <- as.vector(ANOCOVA.data)
ANCOVA <- lm(log(M_avg) ~ log(C_avg) + log(N_avg) + log(P_avg) + dep + as.factor(Year) + as.factor(month),data = ANOCOVA.data)
summary(ANCOVA)
plot(ANCOVA)
resids <- resid(ANCOVA)
fit <-fitted(ANCOVA)
# plotting each nutrient flux against mass flux
#plot(Data.noNA) # we see some relationships between mass flux and the rest of the nutrient fluxes
par(mfrow=c(1,3))
plot(log(Data.noNA$C_avg),log(Data.noNA$M_avg)) #good linearity, but clumping
lmfit_C.M <- lm(log(M_avg) ~ log(C_avg), data = Data.noNA)
summary(lmfit_C.M)
abline(lmfit_C.M)
plot(log(Data.noNA$N_avg),log(Data.noNA$M_avg)) # alright linearity, still clumping
lmfit_N.M <- lm(log(M_avg) ~ log(N_avg), data = Data.noNA)
summary(lmfit_N.M)
abline(lmfit_N.M)
plot(log(Data.noNA$P_avg),log(Data.noNA$M_avg)) # worse, still clumping
lmfit_P.M <- lm(log(M_avg) ~ log(P_avg), data = Data.noNA)
summary(lmfit_P.M)
abline(lmfit_P.M)
summary(lmfit_C.M)
summary(lmfit_N.M)
#n values for C-flux
length(C_flux.depth.150$C_avg.150)
length(C_flux.depth.200$C_avg.200)
length(C_flux.depth.300$C_avg.300)
length(C_flux.depth.400$C_avg.400)
resids <- resid( lmfit_C.M ) # extract epsilon_hats
fit <- fitted ( lmfit_C.M ) # extract y_hats
par(mfrow=c(1,2))
hist(resids, breaks=20)
qqnorm(resids)
qqline(resids) # add straight line from true normal
plot(resids, main="resid vs i")
abline(h=0) # mean of epsilon_hat
plot(x=fit, y=resids, main="resid vs y_hat")
abline(h=0)
resids <- resid( lmfit_N.M ) # extract epsilon_hats
fit <- fitted ( lmfit_N.M ) # extract y_hats
par(mfrow=c(1,2))
hist(resids, breaks=20)
qqnorm(resids)
qqline(resids) # add straight line from true normal
plot(resids, main="resid vs i")
abline(h=0) # mean of epsilon_hat
plot(x=fit, y=resids, main="resid vs y_hat")
abline(h=0)
lmfit.MR <- lm(log(M_avg) ~ log(flux) + dep, data = Data.noNA)
summary(lmfit.MR)
resids <- resid( lmfit.MR ) # extract epsilon_hats
fit <- fitted ( lmfit.MR ) # extract y_hats
par(mfrow=c(1,2))
hist(resids, breaks=20)
qqnorm(resids)
qqline(resids) # add straight line from true normal
plot(resids, main="resid vs i")
abline(h=0) # mean of epsilon_hat
plot(x=fit, y=resids, main="resid vs y_hat")
abline(h=0)
ANOCOVA.data <- subset(Data.noNA, select = c("dep", "M_avg", "C_avg","N_avg","P_avg", "Year", "month"))
ANOCOVA.data <- as.vector(ANOCOVA.data)
ANCOVA <- lm(log(M_avg) ~ log(C_avg) + log(N_avg) + log(P_avg) + dep + as.factor(Year) + as.factor(month),data = ANOCOVA.data)
summary(ANCOVA)
plot(ANCOVA)
resids <- resid(ANCOVA)
fit <-fitted(ANCOVA)
